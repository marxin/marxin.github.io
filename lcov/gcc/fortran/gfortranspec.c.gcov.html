<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - gcc.info - gcc/fortran/gfortranspec.c</title>
  <link rel="stylesheet" type="text/css" href="../../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../../index.html">top level</a> - <a href="index.html">gcc/fortran</a> - gfortranspec.c<span style="font-size: 80%;"> (source / <a href="gfortranspec.c.func-sort-c.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">gcc.info</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">139</td>
            <td class="headerCovTableEntry">167</td>
            <td class="headerCovTableEntryMed">83.2 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2018-09-22 10:58:49</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">6</td>
            <td class="headerCovTableEntry">7</td>
            <td class="headerCovTableEntryMed">85.7 %</td>
          </tr>
          <tr>
            <td class="headerItem">Legend:</td>
            <td class="headerValueLeg">            Lines:
            <span class="coverLegendCov">hit</span>
            <span class="coverLegendNoCov">not hit</span>
</td>
            <td></td>
          </tr>
          <tr><td><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">          Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>            : /* Specific flags and argument handling of the Fortran front-end.</a>
<span class="lineNum">       2 </span>            :    Copyright (C) 1997-2018 Free Software Foundation, Inc.
<span class="lineNum">       3 </span>            : 
<span class="lineNum">       4 </span>            : This file is part of GCC.
<span class="lineNum">       5 </span>            : 
<span class="lineNum">       6 </span>            : GNU CC is free software; you can redistribute it and/or modify
<span class="lineNum">       7 </span>            : it under the terms of the GNU General Public License as published by
<span class="lineNum">       8 </span>            : the Free Software Foundation; either version 3, or (at your option)
<span class="lineNum">       9 </span>            : any later version.
<span class="lineNum">      10 </span>            : 
<span class="lineNum">      11 </span>            : GNU CC is distributed in the hope that it will be useful,
<span class="lineNum">      12 </span>            : but WITHOUT ANY WARRANTY; without even the implied warranty of
<span class="lineNum">      13 </span>            : MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
<span class="lineNum">      14 </span>            : GNU General Public License for more details.
<span class="lineNum">      15 </span>            : 
<span class="lineNum">      16 </span>            : You should have received a copy of the GNU General Public License
<span class="lineNum">      17 </span>            : along with GCC; see the file COPYING3.  If not see
<span class="lineNum">      18 </span>            : &lt;http://www.gnu.org/licenses/&gt;.  */
<span class="lineNum">      19 </span>            : 
<span class="lineNum">      20 </span>            : /* This file is copied more or less verbatim from g77.  */
<span class="lineNum">      21 </span>            : /* This file contains a filter for the main `gcc' driver, which is
<span class="lineNum">      22 </span>            :    replicated for the `gfortran' driver by adding this filter.  The purpose
<span class="lineNum">      23 </span>            :    of this filter is to be basically identical to gcc (in that
<span class="lineNum">      24 </span>            :    it faithfully passes all of the original arguments to gcc) but,
<span class="lineNum">      25 </span>            :    unless explicitly overridden by the user in certain ways, ensure
<span class="lineNum">      26 </span>            :    that the needs of the language supported by this wrapper are met.
<span class="lineNum">      27 </span>            : 
<span class="lineNum">      28 </span>            :    For GNU Fortran 95(gfortran), we do the following to the argument list
<span class="lineNum">      29 </span>            :    before passing it to `gcc':
<span class="lineNum">      30 </span>            : 
<span class="lineNum">      31 </span>            :    1.  Make sure `-lgfortran -lm' is at the end of the list.
<span class="lineNum">      32 </span>            : 
<span class="lineNum">      33 </span>            :    2.  Make sure each time `-lgfortran' or `-lm' is seen, it forms
<span class="lineNum">      34 </span>            :        part of the series `-lgfortran -lm'.
<span class="lineNum">      35 </span>            : 
<span class="lineNum">      36 </span>            :    #1 and #2 are not done if `-nostdlib' or any option that disables
<span class="lineNum">      37 </span>            :    the linking phase is present, or if `-xfoo' is in effect.  Note that
<span class="lineNum">      38 </span>            :    a lack of source files or -l options disables linking.
<span class="lineNum">      39 </span>            : 
<span class="lineNum">      40 </span>            :    This program was originally made out of gcc/cp/g++spec.c, but the
<span class="lineNum">      41 </span>            :    way it builds the new argument list was rewritten so it is much
<span class="lineNum">      42 </span>            :    easier to maintain, improve the way it decides to add or not add
<span class="lineNum">      43 </span>            :    extra arguments, etc.  And several improvements were made in the
<span class="lineNum">      44 </span>            :    handling of arguments, primarily to make it more consistent with
<span class="lineNum">      45 </span>            :    `gcc' itself.  */
<span class="lineNum">      46 </span>            : 
<span class="lineNum">      47 </span>            : #include &quot;config.h&quot;
<span class="lineNum">      48 </span>            : #include &quot;system.h&quot;
<span class="lineNum">      49 </span>            : #include &quot;coretypes.h&quot;
<span class="lineNum">      50 </span>            : #include &quot;opt-suggestions.h&quot;
<span class="lineNum">      51 </span>            : #include &quot;gcc.h&quot;
<span class="lineNum">      52 </span>            : #include &quot;opts.h&quot;
<span class="lineNum">      53 </span>            : 
<span class="lineNum">      54 </span>            : #include &quot;tm.h&quot;
<span class="lineNum">      55 </span>            : #include &quot;intl.h&quot;
<span class="lineNum">      56 </span>            : 
<span class="lineNum">      57 </span>            : #ifndef MATH_LIBRARY
<span class="lineNum">      58 </span>            : #define MATH_LIBRARY &quot;m&quot;
<span class="lineNum">      59 </span>            : #endif
<span class="lineNum">      60 </span>            : 
<span class="lineNum">      61 </span>            : #ifndef FORTRAN_LIBRARY
<span class="lineNum">      62 </span>            : #define FORTRAN_LIBRARY &quot;gfortran&quot;
<span class="lineNum">      63 </span>            : #endif
<span class="lineNum">      64 </span>            : 
<span class="lineNum">      65 </span>            : /* Name of the spec file.  */
<span class="lineNum">      66 </span>            : #define SPEC_FILE &quot;libgfortran.spec&quot;
<span class="lineNum">      67 </span>            : 
<span class="lineNum">      68 </span>            : /* The original argument list and related info is copied here.  */
<span class="lineNum">      69 </span>            : static unsigned int g77_xargc;
<span class="lineNum">      70 </span>            : static const struct cl_decoded_option *g77_x_decoded_options;
<span class="lineNum">      71 </span>            : static void append_arg (const struct cl_decoded_option *);
<span class="lineNum">      72 </span>            : 
<span class="lineNum">      73 </span>            : /* The new argument list will be built here.  */
<span class="lineNum">      74 </span>            : static unsigned int g77_newargc;
<span class="lineNum">      75 </span>            : static struct cl_decoded_option *g77_new_decoded_options;
<span class="lineNum">      76 </span>            : 
<span class="lineNum">      77 </span>            : /* This will be NULL if we encounter a situation where we should not
<span class="lineNum">      78 </span>            :    link in the fortran libraries.  */
<span class="lineNum">      79 </span>            : static const char *library = NULL;
<span class="lineNum">      80 </span>            : 
<span class="lineNum">      81 </span>            : 
<span class="lineNum">      82 </span>            : /* Return whether strings S1 and S2 are both NULL or both the same
<span class="lineNum">      83 </span>            :    string.  */
<a name="84"><span class="lineNum">      84 </span>            : </a>
<span class="lineNum">      85 </span>            : static bool
<span class="lineNum">      86 </span><span class="lineCov">    2131982 : strings_same (const char *s1, const char *s2)</span>
<span class="lineNum">      87 </span>            : {
<span class="lineNum">      88 </span><span class="lineCov">    2131982 :   return s1 == s2 || (s1 != NULL &amp;&amp; s2 != NULL &amp;&amp; strcmp (s1, s2) == 0);</span>
<span class="lineNum">      89 </span>            : }
<span class="lineNum">      90 </span>            : 
<span class="lineNum">      91 </span>            : /* Return whether decoded option structures OPT1 and OPT2 are the
<span class="lineNum">      92 </span>            :    same.  */
<a name="93"><span class="lineNum">      93 </span>            : </a>
<span class="lineNum">      94 </span>            : static bool
<span class="lineNum">      95 </span><span class="lineCov">     368722 : options_same (const struct cl_decoded_option *opt1,</span>
<span class="lineNum">      96 </span>            :               const struct cl_decoded_option *opt2)
<span class="lineNum">      97 </span>            : {
<span class="lineNum">      98 </span><span class="lineCov">     368722 :   return (opt1-&gt;opt_index == opt2-&gt;opt_index</span>
<span class="lineNum">      99 </span><span class="lineCov">     368722 :           &amp;&amp; strings_same (opt1-&gt;arg, opt2-&gt;arg)</span>
<span class="lineNum">     100 </span><span class="lineCov">     352652 :           &amp;&amp; strings_same (opt1-&gt;orig_option_with_args_text,</span>
<span class="lineNum">     101 </span><span class="lineCov">     352652 :                            opt2-&gt;orig_option_with_args_text)</span>
<span class="lineNum">     102 </span><span class="lineCov">     352652 :           &amp;&amp; strings_same (opt1-&gt;canonical_option[0],</span>
<span class="lineNum">     103 </span><span class="lineCov">     352652 :                            opt2-&gt;canonical_option[0])</span>
<span class="lineNum">     104 </span><span class="lineCov">     352652 :           &amp;&amp; strings_same (opt1-&gt;canonical_option[1],</span>
<span class="lineNum">     105 </span><span class="lineCov">     352652 :                            opt2-&gt;canonical_option[1])</span>
<span class="lineNum">     106 </span><span class="lineCov">     352652 :           &amp;&amp; strings_same (opt1-&gt;canonical_option[2],</span>
<span class="lineNum">     107 </span><span class="lineCov">     352652 :                            opt2-&gt;canonical_option[2])</span>
<span class="lineNum">     108 </span><span class="lineCov">     352652 :           &amp;&amp; strings_same (opt1-&gt;canonical_option[3],</span>
<span class="lineNum">     109 </span><span class="lineCov">     352652 :                            opt2-&gt;canonical_option[3])</span>
<span class="lineNum">     110 </span><span class="lineCov">     705304 :           &amp;&amp; (opt1-&gt;canonical_option_num_elements</span>
<span class="lineNum">     111 </span><span class="lineCov">     352652 :               == opt2-&gt;canonical_option_num_elements)</span>
<span class="lineNum">     112 </span><span class="lineCov">     352652 :           &amp;&amp; opt1-&gt;value == opt2-&gt;value</span>
<span class="lineNum">     113 </span><span class="lineCov">     721374 :           &amp;&amp; opt1-&gt;errors == opt2-&gt;errors);</span>
<span class="lineNum">     114 </span>            : }
<span class="lineNum">     115 </span>            : 
<span class="lineNum">     116 </span>            : /* Append another argument to the list being built.  As long as it is
<span class="lineNum">     117 </span>            :    identical to the corresponding arg in the original list, just increment
<span class="lineNum">     118 </span>            :    the new arg count.  Otherwise allocate a new list, etc.  */
<a name="119"><span class="lineNum">     119 </span>            : </a>
<span class="lineNum">     120 </span>            : static void
<span class="lineNum">     121 </span><span class="lineCov">     449277 : append_arg (const struct cl_decoded_option *arg)</span>
<span class="lineNum">     122 </span>            : {
<span class="lineNum">     123 </span><span class="lineCov">     449277 :   static unsigned int newargsize;</span>
<span class="lineNum">     124 </span>            : 
<span class="lineNum">     125 </span><span class="lineCov">     449277 :   if (g77_new_decoded_options == g77_x_decoded_options</span>
<span class="lineNum">     126 </span><span class="lineCov">     368794 :       &amp;&amp; g77_newargc &lt; g77_xargc</span>
<span class="lineNum">     127 </span><span class="lineCov">     817999 :       &amp;&amp; options_same (arg, &amp;g77_x_decoded_options[g77_newargc]))</span>
<span class="lineNum">     128 </span>            :     {
<span class="lineNum">     129 </span><span class="lineCov">     352652 :       ++g77_newargc;</span>
<span class="lineNum">     130 </span><span class="lineCov">     352652 :       return;                   /* Nothing new here.  */</span>
<span class="lineNum">     131 </span>            :     }
<span class="lineNum">     132 </span>            : 
<span class="lineNum">     133 </span><span class="lineCov">      96625 :   if (g77_new_decoded_options == g77_x_decoded_options)</span>
<span class="lineNum">     134 </span>            :     {                           /* Make new arglist.  */
<span class="lineNum">     135 </span><span class="lineCov">      16142 :       unsigned int i;</span>
<span class="lineNum">     136 </span>            : 
<span class="lineNum">     137 </span><span class="lineCov">      16142 :       newargsize = (g77_xargc &lt;&lt; 2) + 20; /* This should handle all.  */</span>
<span class="lineNum">     138 </span><span class="lineCov">      16142 :       g77_new_decoded_options = XNEWVEC (struct cl_decoded_option, newargsize);</span>
<span class="lineNum">     139 </span>            : 
<span class="lineNum">     140 </span>            :       /* Copy what has been done so far.  */
<span class="lineNum">     141 </span><span class="lineCov">     292835 :       for (i = 0; i &lt; g77_newargc; ++i)</span>
<span class="lineNum">     142 </span><span class="lineCov">     276693 :         g77_new_decoded_options[i] = g77_x_decoded_options[i];</span>
<span class="lineNum">     143 </span>            :     }
<span class="lineNum">     144 </span>            : 
<span class="lineNum">     145 </span><span class="lineCov">      96625 :   if (g77_newargc == newargsize)</span>
<span class="lineNum">     146 </span><span class="lineNoCov">          0 :     fatal_error (input_location, &quot;overflowed output arg list for %qs&quot;,</span>
<span class="lineNum">     147 </span><span class="lineNoCov">          0 :                  arg-&gt;orig_option_with_args_text);</span>
<span class="lineNum">     148 </span>            : 
<span class="lineNum">     149 </span><span class="lineCov">      96625 :   g77_new_decoded_options[g77_newargc++] = *arg;</span>
<span class="lineNum">     150 </span>            : }
<span class="lineNum">     151 </span>            : 
<span class="lineNum">     152 </span>            : /* Append an option described by OPT_INDEX, ARG and VALUE to the list
<a name="153"><span class="lineNum">     153 </span>            :    being built.  */</a>
<span class="lineNum">     154 </span>            : static void
<span class="lineNum">     155 </span><span class="lineNoCov">          0 : append_option (size_t opt_index, const char *arg, int value)</span>
<span class="lineNum">     156 </span>            : {
<span class="lineNum">     157 </span><span class="lineCov">      64485 :   struct cl_decoded_option decoded;</span>
<span class="lineNum">     158 </span>            : 
<span class="lineNum">     159 </span><span class="lineNoCov">          0 :   generate_option (opt_index, arg, value, CL_DRIVER, &amp;decoded);</span>
<span class="lineNum">     160 </span><span class="lineCov">      64485 :   append_arg (&amp;decoded);</span>
<span class="lineNum">     161 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">     162 </span>            : 
<span class="lineNum">     163 </span>            : /* Append a libgfortran argument to the list being built.  If
<span class="lineNum">     164 </span>            :    FORCE_STATIC, ensure the library is linked statically.  */
<a name="165"><span class="lineNum">     165 </span>            : </a>
<span class="lineNum">     166 </span>            : static void
<span class="lineNum">     167 </span><span class="lineCov">      32212 : add_arg_libgfortran (bool force_static ATTRIBUTE_UNUSED)</span>
<span class="lineNum">     168 </span>            : {
<span class="lineNum">     169 </span>            : #ifdef HAVE_LD_STATIC_DYNAMIC
<span class="lineNum">     170 </span><span class="lineCov">      32212 :   if (force_static)</span>
<span class="lineNum">     171 </span><span class="lineNoCov">          0 :     append_option (OPT_Wl_, LD_STATIC_OPTION, 1);</span>
<span class="lineNum">     172 </span>            : #endif
<span class="lineNum">     173 </span><span class="lineCov">      32212 :   append_option (OPT_l, FORTRAN_LIBRARY, 1);</span>
<span class="lineNum">     174 </span>            : #ifdef HAVE_LD_STATIC_DYNAMIC
<span class="lineNum">     175 </span><span class="lineCov">      32212 :   if (force_static)</span>
<span class="lineNum">     176 </span><span class="lineNoCov">          0 :     append_option (OPT_Wl_, LD_DYNAMIC_OPTION, 1);</span>
<span class="lineNum">     177 </span>            : #endif
<span class="lineNum">     178 </span><span class="lineCov">      32212 : }</span>
<a name="179"><span class="lineNum">     179 </span>            : </a>
<span class="lineNum">     180 </span>            : void
<span class="lineNum">     181 </span><span class="lineCov">      21354 : lang_specific_driver (struct cl_decoded_option **in_decoded_options,</span>
<span class="lineNum">     182 </span>            :                       unsigned int *in_decoded_options_count,
<span class="lineNum">     183 </span>            :                       int *in_added_libraries ATTRIBUTE_UNUSED)
<span class="lineNum">     184 </span>            : {
<span class="lineNum">     185 </span><span class="lineCov">      21354 :   unsigned int argc = *in_decoded_options_count;</span>
<span class="lineNum">     186 </span><span class="lineCov">      21354 :   struct cl_decoded_option *decoded_options = *in_decoded_options;</span>
<span class="lineNum">     187 </span><span class="lineCov">      21354 :   unsigned int i;</span>
<span class="lineNum">     188 </span><span class="lineCov">      21354 :   int verbose = 0;</span>
<span class="lineNum">     189 </span>            : 
<span class="lineNum">     190 </span>            :   /* 0 =&gt; -xnone in effect.
<span class="lineNum">     191 </span>            :      1 =&gt; -xfoo in effect.  */
<span class="lineNum">     192 </span><span class="lineCov">      21354 :   int saw_speclang = 0;</span>
<span class="lineNum">     193 </span>            : 
<span class="lineNum">     194 </span>            :   /* 0 =&gt; initial/reset state
<span class="lineNum">     195 </span>            :      1 =&gt; last arg was -l&lt;library&gt;
<span class="lineNum">     196 </span>            :      2 =&gt; last two args were -l&lt;library&gt; -lm.  */
<span class="lineNum">     197 </span><span class="lineCov">      21354 :   int saw_library = 0;</span>
<span class="lineNum">     198 </span>            : 
<span class="lineNum">     199 </span>            :   /* By default, we throw on the math library if we have one.  */
<span class="lineNum">     200 </span><span class="lineCov">      21354 :   int need_math = (MATH_LIBRARY[0] != '\0');</span>
<span class="lineNum">     201 </span>            : 
<span class="lineNum">     202 </span>            :   /* Whether we should link a static libgfortran.  */
<span class="lineNum">     203 </span><span class="lineCov">      21354 :   int static_lib = 0; </span>
<span class="lineNum">     204 </span>            : 
<span class="lineNum">     205 </span>            :   /* Whether we need to link statically.  */
<span class="lineNum">     206 </span><span class="lineCov">      21354 :   int static_linking = 0;</span>
<span class="lineNum">     207 </span>            : 
<span class="lineNum">     208 </span>            :   /* The number of input and output files in the incoming arg list.  */
<span class="lineNum">     209 </span><span class="lineCov">      21354 :   int n_infiles = 0;</span>
<span class="lineNum">     210 </span><span class="lineCov">      21354 :   int n_outfiles = 0;</span>
<span class="lineNum">     211 </span>            : 
<span class="lineNum">     212 </span><span class="lineCov">      21354 :   library = FORTRAN_LIBRARY;</span>
<span class="lineNum">     213 </span>            : 
<span class="lineNum">     214 </span>            : #if 0
<span class="lineNum">     215 </span>            :   fprintf (stderr, &quot;Incoming:&quot;);
<span class="lineNum">     216 </span>            :   for (i = 0; i &lt; argc; i++)
<span class="lineNum">     217 </span>            :     fprintf (stderr, &quot; %s&quot;, decoded_options[i].orig_option_with_args_text);
<span class="lineNum">     218 </span>            :   fprintf (stderr, &quot;\n&quot;);
<span class="lineNum">     219 </span>            : #endif
<span class="lineNum">     220 </span>            : 
<span class="lineNum">     221 </span><span class="lineCov">      21354 :   g77_xargc = argc;</span>
<span class="lineNum">     222 </span><span class="lineCov">      21354 :   g77_x_decoded_options = decoded_options;</span>
<span class="lineNum">     223 </span><span class="lineCov">      21354 :   g77_newargc = 0;</span>
<span class="lineNum">     224 </span><span class="lineCov">      21354 :   g77_new_decoded_options = decoded_options;</span>
<span class="lineNum">     225 </span>            : 
<span class="lineNum">     226 </span>            :   /* First pass through arglist.
<span class="lineNum">     227 </span>            : 
<span class="lineNum">     228 </span>            :      If -nostdlib or a &quot;turn-off-linking&quot; option is anywhere in the
<span class="lineNum">     229 </span>            :      command line, don't do any library-option processing (except
<span class="lineNum">     230 </span>            :      relating to -x).  */
<span class="lineNum">     231 </span>            : 
<span class="lineNum">     232 </span><span class="lineCov">     384818 :   for (i = 1; i &lt; argc; ++i)</span>
<span class="lineNum">     233 </span>            :     {
<span class="lineNum">     234 </span><span class="lineCov">     363468 :       if (decoded_options[i].errors &amp; CL_ERR_MISSING_ARG)</span>
<span class="lineNum">     235 </span>            :         continue;
<span class="lineNum">     236 </span>            : 
<span class="lineNum">     237 </span><span class="lineCov">     363468 :       switch (decoded_options[i].opt_index)</span>
<span class="lineNum">     238 </span>            :         {
<span class="lineNum">     239 </span><span class="lineCov">      21726 :         case OPT_SPECIAL_input_file:</span>
<span class="lineNum">     240 </span><span class="lineCov">      21726 :           ++n_infiles;</span>
<span class="lineNum">     241 </span><span class="lineCov">      21726 :           continue;</span>
<span class="lineNum">     242 </span>            : 
<span class="lineNum">     243 </span><span class="lineCov">       5258 :         case OPT_nostdlib:</span>
<span class="lineNum">     244 </span><span class="lineCov">       5258 :         case OPT_nodefaultlibs:</span>
<span class="lineNum">     245 </span><span class="lineCov">       5258 :         case OPT_c:</span>
<span class="lineNum">     246 </span><span class="lineCov">       5258 :         case OPT_r:</span>
<span class="lineNum">     247 </span><span class="lineCov">       5258 :         case OPT_S:</span>
<span class="lineNum">     248 </span><span class="lineCov">       5258 :         case OPT_fsyntax_only:</span>
<span class="lineNum">     249 </span><span class="lineCov">       5258 :         case OPT_E:</span>
<span class="lineNum">     250 </span>            :           /* These options disable linking entirely or linking of the
<span class="lineNum">     251 </span>            :              standard libraries.  */
<span class="lineNum">     252 </span><span class="lineCov">       5258 :           library = 0;</span>
<span class="lineNum">     253 </span><span class="lineCov">       5258 :           break;</span>
<span class="lineNum">     254 </span>            : 
<span class="lineNum">     255 </span><span class="lineNoCov">          0 :         case OPT_static_libgfortran:</span>
<span class="lineNum">     256 </span>            : #ifdef HAVE_LD_STATIC_DYNAMIC
<span class="lineNum">     257 </span><span class="lineNoCov">          0 :           static_lib = 1;</span>
<span class="lineNum">     258 </span>            : #endif
<span class="lineNum">     259 </span><span class="lineNoCov">          0 :           break;</span>
<span class="lineNum">     260 </span>            : 
<span class="lineNum">     261 </span><span class="lineCov">         11 :         case OPT_static:</span>
<span class="lineNum">     262 </span>            : #ifdef HAVE_LD_STATIC_DYNAMIC
<span class="lineNum">     263 </span><span class="lineCov">         11 :           static_linking = 1;</span>
<span class="lineNum">     264 </span>            : #endif
<span class="lineNum">     265 </span><span class="lineCov">         11 :           break;</span>
<span class="lineNum">     266 </span>            : 
<span class="lineNum">     267 </span><span class="lineCov">      16554 :         case OPT_l:</span>
<span class="lineNum">     268 </span><span class="lineCov">      16554 :           ++n_infiles;</span>
<span class="lineNum">     269 </span><span class="lineCov">      16554 :           break;</span>
<span class="lineNum">     270 </span>            : 
<span class="lineNum">     271 </span><span class="lineCov">      21141 :         case OPT_o:</span>
<span class="lineNum">     272 </span><span class="lineCov">      21141 :           ++n_outfiles;</span>
<span class="lineNum">     273 </span><span class="lineCov">      21141 :           break;</span>
<span class="lineNum">     274 </span>            : 
<span class="lineNum">     275 </span><span class="lineCov">          6 :         case OPT_v:</span>
<span class="lineNum">     276 </span><span class="lineCov">          6 :           verbose = 1;</span>
<span class="lineNum">     277 </span><span class="lineCov">          6 :           break;</span>
<span class="lineNum">     278 </span>            : 
<span class="lineNum">     279 </span><span class="lineCov">          4 :         case OPT__version:</span>
<span class="lineNum">     280 </span><span class="lineCov">          4 :           printf (&quot;GNU Fortran %s%s\n&quot;, pkgversion_string, version_string);</span>
<span class="lineNum">     281 </span><span class="lineCov">          4 :           printf (&quot;Copyright %s 2018 Free Software Foundation, Inc.\n&quot;,</span>
<span class="lineNum">     282 </span>            :                   _(&quot;(C)&quot;));
<span class="lineNum">     283 </span><span class="lineCov">          4 :           fputs (_(&quot;This is free software; see the source for copying conditions.  There is NO\n\</span>
<span class="lineNum">     284 </span>            : warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n\n&quot;),
<span class="lineNum">     285 </span>            :                 stdout);
<span class="lineNum">     286 </span><span class="lineCov">          4 :           exit (0);</span>
<span class="lineNum">     287 </span>            :           break;
<span class="lineNum">     288 </span>            : 
<span class="lineNum">     289 </span>            :         case OPT__help:
<span class="lineNum">     290 </span>            :           /* Let gcc.c handle this, as it has a really
<span class="lineNum">     291 </span>            :              cool facility for handling --help and --verbose --help.  */
<span class="lineNum">     292 </span>            :           return;
<span class="lineNum">     293 </span>            : 
<span class="lineNum">     294 </span>            :         default:
<span class="lineNum">     295 </span>            :           break;
<span class="lineNum">     296 </span>            :         }
<span class="lineNum">     297 </span>            :     }
<span class="lineNum">     298 </span>            : 
<span class="lineNum">     299 </span><span class="lineCov">      21350 :   if ((n_outfiles != 0) &amp;&amp; (n_infiles == 0))</span>
<span class="lineNum">     300 </span><span class="lineNoCov">          0 :     fatal_error (input_location,</span>
<span class="lineNum">     301 </span>            :                  &quot;no input files; unwilling to write output files&quot;);
<span class="lineNum">     302 </span>            : 
<span class="lineNum">     303 </span>            :   /* If there are no input files, no need for the library.  */
<span class="lineNum">     304 </span><span class="lineCov">      21350 :   if (n_infiles == 0)</span>
<span class="lineNum">     305 </span><span class="lineCov">         48 :     library = 0;</span>
<span class="lineNum">     306 </span>            : 
<span class="lineNum">     307 </span>            :   /* Second pass through arglist, transforming arguments as appropriate.  */
<span class="lineNum">     308 </span>            : 
<span class="lineNum">     309 </span><span class="lineCov">      21350 :   append_arg (&amp;decoded_options[0]); /* Start with command name, of course.  */</span>
<span class="lineNum">     310 </span>            : 
<span class="lineNum">     311 </span><span class="lineCov">     384792 :   for (i = 1; i &lt; argc; ++i)</span>
<span class="lineNum">     312 </span>            :     {
<span class="lineNum">     313 </span><span class="lineCov">     363442 :       if (decoded_options[i].errors &amp; CL_ERR_MISSING_ARG)</span>
<span class="lineNum">     314 </span>            :         {
<span class="lineNum">     315 </span><span class="lineNoCov">          0 :           append_arg (&amp;decoded_options[i]);</span>
<span class="lineNum">     316 </span><span class="lineNoCov">          0 :           continue;</span>
<span class="lineNum">     317 </span>            :         }
<span class="lineNum">     318 </span>            : 
<span class="lineNum">     319 </span><span class="lineCov">     363442 :       if (decoded_options[i].opt_index == OPT_SPECIAL_input_file</span>
<span class="lineNum">     320 </span><span class="lineCov">      21726 :           &amp;&amp; decoded_options[i].arg[0] == '\0')</span>
<span class="lineNum">     321 </span>            :         {
<span class="lineNum">     322 </span>            :           /* Interesting.  Just append as is.  */
<span class="lineNum">     323 </span><span class="lineNoCov">          0 :           append_arg (&amp;decoded_options[i]);</span>
<span class="lineNum">     324 </span><span class="lineNoCov">          0 :           continue;</span>
<span class="lineNum">     325 </span>            :         }
<span class="lineNum">     326 </span>            : 
<span class="lineNum">     327 </span><span class="lineCov">     363442 :       if (decoded_options[i].opt_index != OPT_l</span>
<span class="lineNum">     328 </span><span class="lineCov">     346888 :           &amp;&amp; (decoded_options[i].opt_index != OPT_SPECIAL_input_file</span>
<span class="lineNum">     329 </span><span class="lineCov">      21726 :               || strcmp (decoded_options[i].arg, &quot;-&quot;) == 0))</span>
<span class="lineNum">     330 </span>            :         {
<span class="lineNum">     331 </span>            :           /* Not a filename or library.  */
<span class="lineNum">     332 </span>            : 
<span class="lineNum">     333 </span><span class="lineCov">     325162 :           if (saw_library == 1 &amp;&amp; need_math)    /* -l&lt;library&gt;.  */</span>
<span class="lineNum">     334 </span><span class="lineNoCov">          0 :             append_option (OPT_l, MATH_LIBRARY, 1);</span>
<span class="lineNum">     335 </span>            : 
<span class="lineNum">     336 </span><span class="lineCov">     325162 :           saw_library = 0;</span>
<span class="lineNum">     337 </span>            : 
<span class="lineNum">     338 </span><span class="lineCov">     325162 :           if (decoded_options[i].opt_index == OPT_SPECIAL_input_file)</span>
<span class="lineNum">     339 </span>            :             {
<span class="lineNum">     340 </span><span class="lineNoCov">          0 :               append_arg (&amp;decoded_options[i]);     /* &quot;-&quot; == Standard input.  */</span>
<span class="lineNum">     341 </span><span class="lineNoCov">          0 :               continue;</span>
<span class="lineNum">     342 </span>            :             }
<span class="lineNum">     343 </span>            : 
<span class="lineNum">     344 </span><span class="lineCov">     325162 :           if (decoded_options[i].opt_index == OPT_x)</span>
<span class="lineNum">     345 </span>            :             {
<span class="lineNum">     346 </span>            :               /* Track input language.  */
<span class="lineNum">     347 </span><span class="lineCov">        189 :               const char *lang = decoded_options[i].arg;</span>
<span class="lineNum">     348 </span>            : 
<span class="lineNum">     349 </span><span class="lineCov">        189 :               saw_speclang = (strcmp (lang, &quot;none&quot;) != 0);</span>
<span class="lineNum">     350 </span>            :             }
<span class="lineNum">     351 </span>            : 
<span class="lineNum">     352 </span><span class="lineCov">     325162 :           append_arg (&amp;decoded_options[i]);</span>
<span class="lineNum">     353 </span>            : 
<span class="lineNum">     354 </span><span class="lineCov">     325162 :           continue;</span>
<span class="lineNum">     355 </span>            :         }
<span class="lineNum">     356 </span>            : 
<span class="lineNum">     357 </span>            :       /* A filename/library, not an option.  */
<span class="lineNum">     358 </span>            : 
<span class="lineNum">     359 </span><span class="lineCov">      38280 :       if (saw_speclang)</span>
<span class="lineNum">     360 </span>            :         saw_library = 0;        /* -xfoo currently active.  */
<span class="lineNum">     361 </span>            :       else
<span class="lineNum">     362 </span>            :         {                       /* -lfoo or filename.  */
<span class="lineNum">     363 </span><span class="lineCov">      38014 :           if (decoded_options[i].opt_index == OPT_l</span>
<span class="lineNum">     364 </span><span class="lineCov">      16542 :               &amp;&amp; strcmp (decoded_options[i].arg, MATH_LIBRARY) == 0)</span>
<span class="lineNum">     365 </span>            :             {
<span class="lineNum">     366 </span><span class="lineCov">      16070 :               if (saw_library == 1)</span>
<span class="lineNum">     367 </span>            :                 saw_library = 2;        /* -l&lt;library&gt; -lm.  */
<span class="lineNum">     368 </span>            :               else
<span class="lineNum">     369 </span><span class="lineCov">      16070 :                 add_arg_libgfortran (static_lib &amp;&amp; !static_linking);</span>
<span class="lineNum">     370 </span>            :             }
<span class="lineNum">     371 </span><span class="lineCov">      21944 :           else if (decoded_options[i].opt_index == OPT_l</span>
<span class="lineNum">     372 </span><span class="lineCov">        472 :               &amp;&amp; strcmp (decoded_options[i].arg, FORTRAN_LIBRARY) == 0)</span>
<span class="lineNum">     373 </span>            :             {
<span class="lineNum">     374 </span><span class="lineNoCov">          0 :               saw_library = 1;  /* -l&lt;library&gt;.  */</span>
<span class="lineNum">     375 </span><span class="lineNoCov">          0 :               add_arg_libgfortran (static_lib &amp;&amp; !static_linking);</span>
<span class="lineNum">     376 </span><span class="lineNoCov">          0 :               continue;</span>
<span class="lineNum">     377 </span>            :             }
<span class="lineNum">     378 </span>            :           else
<span class="lineNum">     379 </span>            :             {                   /* Other library, or filename.  */
<span class="lineNum">     380 </span><span class="lineCov">      21944 :               if (saw_library == 1 &amp;&amp; need_math)</span>
<span class="lineNum">     381 </span><span class="lineNoCov">          0 :                 append_option (OPT_l, MATH_LIBRARY, 1);</span>
<span class="lineNum">     382 </span>            :               saw_library = 0;
<span class="lineNum">     383 </span>            :             }
<span class="lineNum">     384 </span>            :         }
<span class="lineNum">     385 </span><span class="lineCov">      38280 :       append_arg (&amp;decoded_options[i]);</span>
<span class="lineNum">     386 </span>            :     }
<span class="lineNum">     387 </span>            : 
<span class="lineNum">     388 </span>            :   /* Append `-lgfortran -lm' as necessary.  */
<span class="lineNum">     389 </span>            : 
<span class="lineNum">     390 </span><span class="lineCov">      21350 :   if (library)</span>
<span class="lineNum">     391 </span>            :     {                           /* Doing a link and no -nostdlib.  */
<span class="lineNum">     392 </span><span class="lineCov">      16142 :       if (saw_speclang)</span>
<span class="lineNum">     393 </span><span class="lineNoCov">          0 :         append_option (OPT_x, &quot;none&quot;, 1);</span>
<span class="lineNum">     394 </span>            : 
<span class="lineNum">     395 </span><span class="lineCov">      16142 :       switch (saw_library)</span>
<span class="lineNum">     396 </span>            :         {
<span class="lineNum">     397 </span><span class="lineCov">      16142 :         case 0:</span>
<span class="lineNum">     398 </span><span class="lineCov">      16142 :           add_arg_libgfortran (static_lib &amp;&amp; !static_linking);</span>
<span class="lineNum">     399 </span>            :           /* Fall through.  */
<span class="lineNum">     400 </span>            : 
<span class="lineNum">     401 </span><span class="lineCov">      16142 :         case 1:</span>
<span class="lineNum">     402 </span><span class="lineCov">      16142 :           if (need_math)</span>
<span class="lineNum">     403 </span><span class="lineCov">      16142 :             append_option (OPT_l, MATH_LIBRARY, 1);</span>
<span class="lineNum">     404 </span>            :         default:
<span class="lineNum">     405 </span>            :           break;
<span class="lineNum">     406 </span>            :         }
<span class="lineNum">     407 </span>            :     }
<span class="lineNum">     408 </span>            : 
<span class="lineNum">     409 </span>            : #ifdef ENABLE_SHARED_LIBGCC
<span class="lineNum">     410 </span><span class="lineCov">      21350 :   if (library)</span>
<span class="lineNum">     411 </span>            :     {
<span class="lineNum">     412 </span>            :       unsigned int i;
<span class="lineNum">     413 </span>            : 
<span class="lineNum">     414 </span><span class="lineCov">     357074 :       for (i = 1; i &lt; g77_newargc; i++)</span>
<span class="lineNum">     415 </span><span class="lineCov">     340943 :         if (g77_new_decoded_options[i].opt_index == OPT_static_libgcc</span>
<span class="lineNum">     416 </span><span class="lineCov">     340943 :             || g77_new_decoded_options[i].opt_index == OPT_static)</span>
<span class="lineNum">     417 </span>            :           break;
<span class="lineNum">     418 </span>            : 
<span class="lineNum">     419 </span><span class="lineCov">      16142 :       if (i == g77_newargc)</span>
<span class="lineNum">     420 </span><span class="lineCov">      16131 :         append_option (OPT_shared_libgcc, NULL, 1);</span>
<span class="lineNum">     421 </span>            :     }
<span class="lineNum">     422 </span>            : 
<span class="lineNum">     423 </span>            : #endif
<span class="lineNum">     424 </span>            : 
<span class="lineNum">     425 </span><span class="lineCov">      21350 :   if (verbose &amp;&amp; g77_new_decoded_options != g77_x_decoded_options)</span>
<span class="lineNum">     426 </span>            :     {
<span class="lineNum">     427 </span><span class="lineNoCov">          0 :       fprintf (stderr, _(&quot;Driving:&quot;));</span>
<span class="lineNum">     428 </span><span class="lineNoCov">          0 :       for (i = 0; i &lt; g77_newargc; i++)</span>
<span class="lineNum">     429 </span><span class="lineNoCov">          0 :         fprintf (stderr, &quot; %s&quot;,</span>
<span class="lineNum">     430 </span><span class="lineNoCov">          0 :                  g77_new_decoded_options[i].orig_option_with_args_text);</span>
<span class="lineNum">     431 </span><span class="lineNoCov">          0 :       fprintf (stderr, &quot;\n&quot;);</span>
<span class="lineNum">     432 </span>            :     }
<span class="lineNum">     433 </span>            : 
<span class="lineNum">     434 </span><span class="lineCov">      21350 :   *in_decoded_options_count = g77_newargc;</span>
<span class="lineNum">     435 </span><span class="lineCov">      21350 :   *in_decoded_options = g77_new_decoded_options;</span>
<span class="lineNum">     436 </span>            : }
<span class="lineNum">     437 </span>            : 
<span class="lineNum">     438 </span>            : 
<a name="439"><span class="lineNum">     439 </span>            : /* Called before linking.  Returns 0 on success and -1 on failure.  */</a>
<span class="lineNum">     440 </span>            : int
<span class="lineNum">     441 </span><span class="lineCov">      19853 : lang_specific_pre_link (void)</span>
<span class="lineNum">     442 </span>            : {
<span class="lineNum">     443 </span><span class="lineCov">      19853 :   if (library)</span>
<span class="lineNum">     444 </span><span class="lineCov">      16141 :     do_spec (&quot;%:include(libgfortran.spec)&quot;);</span>
<span class="lineNum">     445 </span>            : 
<span class="lineNum">     446 </span><span class="lineCov">      19853 :   return 0;</span>
<span class="lineNum">     447 </span>            : }
<span class="lineNum">     448 </span>            : 
<span class="lineNum">     449 </span>            : /* Number of extra output files that lang_specific_pre_link may generate.  */
<span class="lineNum">     450 </span>            : int lang_specific_extra_outfiles = 0;   /* Not used for F77.  */
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.0</a></td></tr>
  </table>
  <br>
<h3>LCOV profile is generated on x86_64 machine using following configure options: configure --disable-bootstrap --enable-coverage=opt --enable-languages=c,c++,fortran,go,jit,lto --enable-host-shared. GCC test suite is run with the built compiler.</h3></body></html>
